# <a name="internet-of-things-security-architecture"></a>物聯網安全性架構
在設計系統時，我們應了解該系統的潛在威脅並加入適當的防禦機制，以妥善設計系統與其架構。 在一開始設計產品時就先考量安全性是非常重要的，因為了解攻擊者可能如何破壞系統，有助於從一開始就備妥適當的安全防護功能。 

## <a name="security-starts-with-a-threat-model"></a>保障安全從威脅模型開始
Microsoft 產品在採用威脅模型方面的經驗悠久，並已公開發表公司的威脅模型化程序。 Microsoft 的成功經驗證實，模型化除了可以立即掌握哪些是最關鍵的威脅，還擁有超越期望的優點。 比方說，模型化作業也能建立與其他外部開發團隊開放討論的管道，以獲取產品的新構想和增強功能。

威脅模型化作業的目標是了解攻擊者可能如何破壞系統，以確保備妥適當的安全防護功能。 威脅模型化作業可確保設計團隊在系統設計階段就考慮安全防護功能，而不是等到系統部署之後才亡羊補牢。 這一點是非常重要的，因為要現場修改大量裝置的安全性防禦措施非但不可行、容易產生錯誤，也會讓客戶面臨風險。

許多開發團隊能精準掌握對客戶有益的系統功能需求。 不過，識別有心人士可能如何濫用系統的隱匿方式則更具挑戰性。 威脅模型化作業可協助開發團隊了解攻擊者可能採取的行動和原因。 威脅模型化作業是一種結構化的程序，其可建立系統安全設計決策的討論，以及過程中的設計變更會對安全性產生哪些影響。 雖然威脅模型只是一種文件，但這份文件也是傳承知識、保存所學經驗，並協助新小組快速上手的理想方式。 最後，威脅模型化作業的結果應可讓您考慮安全性的其他層面，例如想要提供給客戶哪些安全性承諾。 將這些承諾與威脅模型化作業搭配使用，即可針對您的物聯網 (IoT) 方案提供分析與行動測試。

### <a name="when-to-threat-model"></a>進行威脅模型化作業的時機
在設計階段中納入[威脅模型化作業](http://www.microsoft.com/security/sdl/adopt/threatmodeling.aspx)時，才能發揮最大效益。 因為只有在設計階段，您才有最大的彈性空間可進行威脅排除變更。 最理想的結果就是透過設計來排除潛在威脅。 這麼做比新增安全防護功能、加以測試，並確保它們保持最新狀態等作業更加容易，因為排除作業不是隨時想做就能做。 當產品日益成熟，排除威脅會更加困難，相較於開發早期採用的威脅模型化作業，這需要更多投入與更高難度的取捨。

### <a name="what-to-threat-model"></a>威脅模型化作業該注意什麼？
您應該將模型與整個方案整合成一體，同時將焦點放在下列領域︰

* 安全性與隱私權功能
* 其成敗會影響安全性的相關功能
* 觸及信任邊界的功能 

### <a name="who-threat-models"></a>威脅模型跟誰有關
威脅模型化作業與任何其他程序一樣。  建議您將威脅模型文件視為方案的任何其他元件，並加以驗證。 許多開發團隊能精準掌握對客戶有益的系統功能需求。 不過，識別有心人士可能如何濫用系統的隱匿方式則更具挑戰性。 威脅模型化作業可協助開發團隊了解攻擊者可能採取的行動和原因。

### <a name="how-to-threat-model"></a>如何使用威脅模型
威脅模型化作業程序包含下列四個步驟：

* 應用程式建模
* 列舉威脅
* 降低威脅的風險
* 驗證安全防護功能

#### <a name="the-process-steps"></a>程序步驟
建立威脅模型時，請謹記下列三個基本原則︰

1. 建立參考架構圖表。 
2. 先從廣度下手。 取得概觀，先概略了解整個系統，再進行深入工作。  這有助確保您在適當的位置進行深入工作。
3. 由您來控制程序，而不是受到程序的擺佈。 如果您在模型化作業階段發現問題，並想要加以探索，儘管放心去做！  您並不需要盲目遵循這些步驟。  

#### <a name="threats"></a>威脅
威脅模型的四個核心項目為︰

* 處理序 (Web 服務、Win32 服務、*nix daemons 等)請注意，如果無法在這些區域中進行技術性向下鑽研時，可將部分複雜的實體 (例如現場閘道器和感應器) 抽象化為處理序。
* 資料存放區 (儲存資料的任何位置，例如組態檔或資料庫)
* 資料流程 (其中資料會在應用程式的其他項目之間移動)
* 外部實體 (與系統互動但不在應用程式控制之下的任何項目，例如使用者和附屬摘要)

架構圖中的所有項目皆受限於各種威脅；針對這些威脅，我們將使用 STRIDE 助憶鍵。 請閱讀 [Threat Modeling Again, STRIDE](https://blogs.msdn.microsoft.com/larryosterman/2007/09/04/threat-modeling-again-stride/) (威脅模型化作業重點 STRIDE)，以深入了解 STRIDE 元素。

應用程式圖表的不同項目受限於特定 STRIDE 威脅而定︰

* 處理序受限於 STRIDE
* 資料流程受限於 TID
* 資料存放區受限於 TID，有時受限於 R (如果資料存放區是記錄檔的話)。
* 外部實體受限於 SRD

## <a name="security-in-iot"></a>IoT 中的安全性
特殊用途的連線裝置具有大量的潛在互動介面區與互動模式，您必須全面考慮所有項目才能提供適當的架構，以保護這些裝置的數位存取安全。 此處的「數位存取」一詞是用來與透過直接裝置互動來執行的任何作業進行區隔，而直接互動的存取安全性是透過實體存取控制來保障。 例如，將裝置放入室內，然後將門上鎖。 雖然實體存取無法透過軟體和硬體拒絕存取，仍可採取一些措施來防止實體存取干擾系統。 

在探索互動模式時，我們會對「裝置控制」和「裝置資料」同等重視。 「裝置控制」可以歸類為任一方提供給裝置的任何資訊，其目標是要變更或影響裝置針對其狀態或環境狀態的行為。 「裝置資料」可以歸類為任何資訊，其為裝置發出給另一方的裝置狀態和環境觀察狀態相關資訊。

為了發揮安全性最佳做法的最大效益，建議您將典型的 IoT 架構分割成若干元件/區域，以作為威脅模型化作業練習的一部分。 本節會詳細說明這些區域，並包括下列重點︰

* 裝置、
* 現場閘道器、
* 雲端閘道器以及
* 宣告型授權。

區域是從廣度方面來區隔方案；每個區域通常會有它自己的資料以及驗證和授權需求。 區域也可以用來隔離損毀，並限制低度信任區域對較高信任區域的影響。

每個區域都由信任邊界來區隔；下圖中其以紅色虛線標示。 它代表從某個來源到另一個來源之間的資料/資訊轉換。 在這項轉換期間，資料/資訊可能會受限於 STRIDE 的影響，亦即詐騙 (Spoofing)、竄改 (Tampering)、否認性 (Repudiation)、資訊洩漏 (Information Disclosure)、拒絕服務 (Denial of Service) 與權限提高 (Elevation of Privileg)。

![IoT 安全性區域](media/iot-security-architecture/iot-security-architecture-fig1.png) 

每個邊界內所描述的元件也會受限於 STRIDE 的影響，因此我們需啟用方案的全方位威脅模型化作業檢視。 下列章節詳述每個元件和特定的安全性考量，以及應備妥的解決方案。

後續章節將討論這些區域中常見的標準元件。

### <a name="the-device-zone"></a>裝置區域
裝置環境是指裝置周圍即時的實體空間，其中可進行裝置的實體存取及/或「區域網路」對等式數位存取。 「區域網路 」則假設為不同的隔離網路，但可能橋接至公用網際網路，並包含任何短程無線電技術以讓裝置進行對等式通訊。 它*不*包括任何網路虛擬化技術 (其會建立這類區域網路的假象)，也不包含公用電信營運商的網路 (其中任兩個裝置需要具備對等式通訊關聯，才能跨公用網路空間進行通訊)。

### <a name="the-field-gateway-zone"></a>現場閘道器區域
現場閘道器是一種裝置/應用裝置，或作為通訊啟用器的一般用途伺服器電腦軟體，甚至可能是裝置控制系統和裝置資料處理中心。 現場閘道器的區域包括現場閘道器本身以及連接到它的所有裝置。 正如其名，現場閘道器可作為外部專用的資料處理設備，通常會和位置繫結，亦可能受限於實體入侵的影響，並具有限的作業備援。 簡而言之，現場閘道器是在大家知道其功能以後，最容易觸及與蓄意破壞的裝置。 

現場閘道器和單純的流量路由器不同，它在管理存取與資料流程方面扮演積極的角色，這表示它是由應用程式處理之實體和網路連線或工作階段的終端。 相反地，NAT 裝置或防火牆並不算現場閘道器，因為它們並不是明確的連線或工作階段的終端，而是連線或工作階段經過的路線 (或區塊)。 現場閘道器有兩個不同的介面區。 一個介面區表示區域的內部，並面對連接到該區的裝置，而另一個介面區表示區域的邊緣，並面對所有外部方。   

### <a name="the-cloud-gateway-zone"></a>雲端閘道器區域
雲端閘道器是一種系統，其可讓跨公用網路空間之數個不同站台的裝置之間進行遠端通訊；其通常是針對雲端式控制和資料分析系統，也可說是這類系統的同盟。 在某些情況下，雲端閘道器可立即提升特殊用途裝置的終端機存取速度 (如平板電腦或手機)。 在此處所討論的內容中，「雲端」是指未繫結至連接裝置或現場閘道器之相同網站的專屬資料處理系統。 此外，在雲端區域中，用來防止實體存取目標的作業措施並不一定要向 「公用雲端」基礎結構公開。  

雲端閘道器可能會對應到網路虛擬化重疊，以隔離雲端閘道器與所有連接裝置或現場閘道器的任何其他網路流量。 雲端閘道器本身不屬於裝置控制系統，也不是處理或儲存裝置資料的設備；反之，是這些設備與雲端閘道器接合。 雲端閘道器區域包含雲端閘道器和所有現場閘道器，以及直接或間接連接其上的裝置。 區域邊緣是不同的介面區，所有外部方會透過這裡進行通訊。

### <a name="the-services-zone"></a>服務區域
本內容將「服務」定義為任何軟體元件或模組，其透過現場閘道器或雲端閘道器來與裝置互動、進行資料收集和分析，以及命令與控制等功能。  服務是一種中介程序。 它們會以面向閘道和其他子系統的身分識別來執行動作、儲存和分析資料、根據資料的深入資訊或排程自動向裝置發出命令，並向授權使用者公開資訊與控制功能。

### <a name="information-devices-vs-special-purpose-devices"></a>資訊裝置與特殊用途的裝置
PC、手機和平板電腦主要的互動式資訊裝置。 手機和平板電腦是特別為了發揮最大電池續航力而最佳化的產品。 當不需立即與人員進行互動，或是不提供播放音樂或為裝置擁有者進行路線規劃等服務時，最好將這些裝置部分關閉。 從系統觀點來看，這些資訊技術裝置主要是作為面對人的 Proxy。 也就是說，它們是建議動作的「人類傳動器」，以及收集輸入的「人類感應器」。 

特殊用途的裝置則各有不同，從簡單的溫度感應器到每條生產線內含有上千個元件的複雜工廠生產線皆算在內。 這類裝置主要是以實際用途為目的，即使提供使用者介面，多半都只限於用來接合或整合在現實生活中的資產。 它們可以測量和報告環境情況、開啟閥門、 控制伺服、發出警報、切換燈號，以及執行許多其他工作。 如果使用資訊裝置進行某些工作會大材小用、過於昂貴、過大或太脆弱，就可以改用特殊用途的裝置。 這類裝置的具體用途決定了它們的技術設計，包括可用的生產預算金額與預定的生命週期作業。 這兩項關鍵因素的組合會限制可用的作業能源預算、實際使用量，乃至於可用的儲存空間、計算和安全性功能。  

如果具自動化功能或可遠端控制的裝置發生某些問題，例如，實體瑕疵或控制邏輯瑕疵導致蓄意的未經授權入侵和操作， 則可能會導致生產工廠毀壞、大樓被掠奪或燒毀，甚至可能造成人員傷亡。 這類損失的等級顯然比信用卡遭竊並被刷爆來得嚴重。 因此，如果是涉及物品移動的裝置以及最終會發出命令導致物品移動的感應器資料，這樣的安全性標準就必須高於任何電子商務或銀行的案例。 

### <a name="device-control-and-device-data-interactions"></a>裝置控制和裝置資料的互動
特殊用途的連線裝置具有大量的潛在互動介面區與互動模式，您必須全面考慮所有項目才能提供適當的架構，以保護這些裝置的數位存取安全。 此處的「數位存取」一詞是用來與透過直接裝置互動來執行的任何作業進行區隔，而直接互動的存取安全性是透過實體存取控制來保障。 例如，將裝置放入室內，然後將門上鎖。 雖然實體存取無法透過軟體和硬體拒絕存取，仍可採取一些措施來防止實體存取干擾系統。 

在探索互動模式與進行威脅模型時，我們會對「裝置控制」和「裝置資料」同等重視。 「裝置控制」可以歸類為任一方提供給裝置的任何資訊，其目標是要變更或影響裝置針對其狀態或環境狀態的行為。 「裝置資料」可以歸類為任何資訊，其為裝置發出給另一方的裝置狀態和環境觀察狀態相關資訊。 

## <a name="threat-modeling-the-azure-iot-reference-architecture"></a>為 Azure IoT 參考架構進行威脅模型化作業
Microsoft 是使用以上概述的架構來為 Azure IoT 進行威脅模型化作業。 因此，在下一節中，我們會使用 Azure IoT 參考架構的具體範例來示範如何分析 IoT 威脅模型化作業，以及如何處理所識別的威脅。 在本案例中，我們會識別下列四個主要的區域︰

* 裝置和資料來源、
* 資料傳輸、
* 裝置和事件處理以及
* 展示

![Azure IoT 的威脅模型化作業](media/iot-security-architecture/iot-security-architecture-fig2.png) 

下圖提供簡化的 Microsoft IoT 架構檢視，該架構使用 Microsoft 威脅模型化工具所用的資料流程圖模型︰

![使用 MS 威脅模型化工具進行 Azure IoT 威脅模型化作業](media/iot-security-architecture/iot-security-architecture-fig3.png)

請注意，該架構將裝置和閘道器功能區隔開來。 這可讓使用者運用更安全的閘道裝置：這類裝置可以使用安全的通訊協定與雲端閘道進行通訊，且通常需要的處理負荷高於原生裝置 (例如控溫器) 可自行提供的量。 在 Azure 服務區域中，我們假設 Azure IoT 中樞服務代表雲端閘道器。

### <a name="device-and-data-sourcesdata-transport"></a>裝置與資料來源/資料傳輸
本節將放大檢視威脅模型化作業，以探討之前概述的架構，並提供如何解決一些固有考量的概述。 我們將著重在威脅模型的核心項目︰

* 處理序 (包括我們所掌控的處理序以及外部項目)
* 通訊 (也稱為資料流程)
* 儲存體 (也稱為資料存放區)

#### <a name="processes"></a>處理序
在 Azure IoT 架構所概述的每個類別中，我們嘗試跨資料/資訊存在的三個階段來降低不同威脅的風險：處理序、通訊以及儲存體。 下面我們提供「處理序」分類中最常見之威脅的概觀，並概要說明如何以最妥善的方式降低這些威脅的風險︰ 

**詐騙 (S)**：攻擊者可能會從裝置擷取密碼編譯金鑰資料 (不論軟體或硬體層級)，接著利用取得密碼編譯金鑰資料之裝置的身分識別，搭配不同的實體或虛擬裝置來存取系統。 遙控器就是很好的一例，既可以遙控電視機，也是很熱門的惡作劇工具。

**拒絕服務 (D)**：藉由干擾無線電頻率或剪斷線路，導致可以轉譯的裝置無法運作或無法通訊。 例如，蓄意破壞監控攝影機的電源或網路連線，使其完全無法回報資料。

**竄改 (T)**：如果非法程式可以使用金鑰資料或保存金鑰資料的密碼編譯設備，攻擊者可能會部分或全部取代裝置上執行的軟體，藉此讓取而代之的軟體運用裝置的正版身分識別。 例如，攻擊者可能會利用擷取的金鑰資料，來攔截和隱藏通訊路徑上的裝置資料，並以竊取的金鑰資料來通過驗證，再以假資料取而代之。

**資訊洩漏 (I)**：如果裝置正在執行受操控的軟體，這類受操控的軟體可能會將資料洩漏給未經授權的一方。 例如，攻擊者可能利用擷取的金鑰資料以介入裝置、控制器、現場閘道器或雲端閘道之間的通訊路徑，藉此竊取資訊。

**權限提高 (E)**：具有特定功能的裝置可能會被強制執行其他動作。 例如，程式設計為半開的閥門可能會受騙而完全打開。

| **元件** | **威脅** | **緩和** | **風險** | **實作** |
| --- | --- | --- | --- | --- |
| 裝置 |S |指派身分識別給裝置並驗證裝置 |用其他裝置取代裝置或部分裝置。 該怎麼判斷我們是在跟正確的裝置通訊？ |使用傳輸層安全性 (TLS) 或 IPSec 來驗證裝置。 如果裝置無法處理完整的非對稱密碼編譯，則基礎結構應該支援在這些裝置上使用預先共用金鑰 (PSK)。 利用 Azure AD、[OAuth](http://www.rfc-editor.org/in-notes/internet-drafts/draft-ietf-ace-oauth-authz-01.txt) |
| TRID |藉由讓人很難甚至不可能從裝置擷取金鑰和其他密碼編譯資料，以為裝置套用防竄改機制。 |但風險是我們不知道裝置是不是已經受到竄改 (實體干擾)？ 該怎麼確認裝置未受到竄改？ |最有效的安全防護功能是信賴平台模組 (TPM) 功能，其可讓您將金鑰存放在特殊的晶片電路中，以確保金鑰不被讀取，但僅適用於只使用金鑰而不會揭露金鑰的密碼編譯作業。 裝置的記憶體加密。 裝置的金鑰管理。 簽署程式碼。 | |
| E |具有裝置的存取控制。 授權配置。 |如果裝置可以依據外部來源或甚至遭入侵之感應器的命令來執行個別動作，這意謂著攻擊可以藉此執行作業，而不僅是存取內容。 |為裝置進行授權配置 | |
| 現場閘道器 |S |現場閘道器到雲端閘道器的驗證 (憑證式、PSK、宣告式...) |如果有心人士可以欺騙現場閘道器，就可以偽裝成任何裝置。 |TLS RSA/PSK、IPSec、[RFC 4279](https://tools.ietf.org/html/rfc4279)。 同樣地，一般的裝置金鑰儲存和證明考量都高度建議使用 TPM。 IPSec 的 6LowPAN 擴充可支援無線感測網路 (WSN)。 |
| TRID |保護現場閘道器免遭竄改 (TPM？) |詐騙攻擊會讓雲端閘道器誤以為和現場閘道器通訊，而可能導致資訊洩漏與資料遭竄改。 |記憶體加密、TPM、驗證。 | |
| E |現場閘道器的存取控制機制 | | | |

以下是這類威脅的一些範例︰

詐騙︰攻擊者可能會從裝置擷取密碼編譯金鑰資料 (不論軟體或硬體層級)，接著利用取得密碼編譯金鑰資料之裝置的身分識別，搭配不同的實體或虛擬裝置來存取系統。

**阻斷服務**：藉由干擾無線電頻率或剪斷線路，即可讓裝置變成無法運作或通訊。 例如，蓄意破壞監控攝影機的電源或網路連線，使其完全無法回報資料。

**竄改**：如果非法程式可以使用金鑰資料或保存金鑰資料的密碼編譯設備，攻擊者便可能部分取代或全部取代裝置上執行的軟體，而可能讓替代的軟體擅用裝置的真實身分識別。

**竄改**：監控攝影機如果是顯示空走廊的可見範圍影像，可能會被對著這類走廊的照片拍攝。 煙霧或火災感應器可能會回報下方有人手持打火機。 任一種情況下，系統可能會在技術上完全信任裝置，但是裝置回報的資訊卻有可能受到操控。

**竄改**：攻擊者可能會利用擷取的金鑰資料來攔截和隱藏通訊路徑上來自裝置的資料，然後使用以竊取的金鑰資料通過驗證的假資料來取而代之。

**竄改**：如果非法程式可以使用金鑰資料或保存金鑰資料的密碼編譯設備，攻擊者便可能部分取代或全部取代裝置上執行的軟體，而可能讓替代的軟體擅用裝置的真實身分識別。

**資訊洩漏**：如果裝置正在執行受操控的軟體，這類受操控的軟體可能會將資料洩漏給未經授權的一方。

**資訊洩漏**：攻擊者可能利用擷取的金鑰資料讓自己介入裝置與控制器、現場閘道或雲端閘道之間的通訊路徑，藉此竊取資訊。

**阻斷服務**：可將裝置關閉或轉換成無法通訊的模式 (許多產業用機器會刻意設計此功能)。

**竄改**：可將裝置重新設定成以控制系統不知的狀態運作 (在已知的校正參數範圍外)，藉此提供可能被誤解的資料

**權限提高**：具有特定功能的裝置可能會被強制執行其他動作。 例如，程式設計為半開的閥門可能會受騙而完全打開。

**阻斷服務**：可將裝置轉換成無法通訊的狀態。

**竄改**：可將裝置重新設定成以控制系統不知的狀態運作 (在已知的校正參數範圍外)，藉此提供可能被誤解的資料。

**詐騙/竄改/否認性**：在未受保護的情況下 (消費性遙控器很少有這種情況)，攻擊者將能夠以匿名方式操控裝置的狀態。 遙控器就是很好的一例，既可以遙控電視機，也是很熱門的惡作劇工具。

#### <a name="communication"></a>通訊
裝置、裝置和現場閘道器，以及裝置和雲端閘道器之間的通訊路徑周遭，也佈滿威脅。 針對位於開啟的通訊端上的裝置/VPN，下表提供相關指引︰

| **元件** | **威脅** | **緩和** | **風險** | **實作** |
| --- | --- | --- | --- | --- |
| 裝置 IoT 中樞 |TID |使用 (D)TLS (PSK/RSA) 以加密流量 |竊聽或干擾裝置與閘道器之間的通訊 |通訊協定層級的安全性。 使用自訂通訊協定時，我們需要了解如何對其進行保護。 在大部分情況下，通訊主要是發生在裝置到 IoT 中樞這一段位置 (由裝置起始連線)。 |
| 裝置裝置 |TID |使用 (D)TLS (PSK/RSA) 以加密流量。 |讀取裝置間傳輸中的資料。 竄改資料。 多載具有新連線的裝置 |通訊協定層級的安全性 (MQTT/AMQP/HTTP/CoAP)。 使用自訂通訊協定時，我們需要了解如何對其進行保護。 DoS 威脅的安全防護功能是透過雲端閘道器或現場閘道器，將裝置設為對等，使其僅可以網路用戶端形式運作。 在閘道器代理對等之後，對等作業可能會導致對等之間直接連線。 |
| 外部實體裝置 |TID |外部實體與裝置的強式配對 |竊聽裝置的連線。 干擾裝置的通訊 |使用 NFC/Bluetooth LE 安全地配對外部實體與裝置。 控制裝置 (實體) 的操作面板 |
| 現場閘道雲端閘道 |TID |使用 TLS (PSK/RSA) 以加密流量。 |竊聽或干擾裝置與閘道器之間的通訊 |通訊協定層級的安全性 (MQTT/AMQP/HTTP/CoAP)。 使用自訂通訊協定時，我們需要了解如何對其進行保護。 |
| 裝置雲端閘道 |TID |使用 TLS (PSK/RSA) 以加密流量。 |竊聽或干擾裝置與閘道器之間的通訊 |通訊協定層級的安全性 (MQTT/AMQP/HTTP/CoAP)。 使用自訂通訊協定時，我們需要了解如何對其進行保護。 |

以下是這類威脅的一些範例︰

**阻斷服務**：受限裝置在主動接聽輸入連線或網路上來路不明的資料包時，通常會處於 DoS 威脅之下，因為攻擊者可以平行開啟許多連線但卻不提供服務或以非常緩慢的速度提供服務，或是裝置可能會被來路不明的流量給塞爆。 在這兩種情況下，都會讓裝置在網路上實際變成無法運作。

**詐騙、資訊洩漏**：受限裝置和特殊用途裝置通常會有通用型安全性措施 (例如密碼或 PIN 碼保護)，或是完全仰賴網路授信，也就是只要裝置位在相同的網路中，就會授與資訊的存取權，而該網路通常只受到共用金鑰保護。 這表示當裝置或網路共用的密碼遭公開時，有心人士就可以控制裝置或觀察從裝置發出的資料。  

**詐騙**：攻擊者可能對廣播進行攔截或部分覆寫，然後詐騙建立者 (攔截式)

**竄改**：攻擊者可能會攔截或部分覆寫廣播，並傳送錯誤的資訊 

**資訊洩漏**：攻擊者可能會竊聽廣播並在未經授權的情況下取得資訊。**阻斷服務**：攻擊者可能會干擾廣播訊號並拒絕資訊散發

#### <a name="storage"></a>儲存體
每個裝置和現場閘道器都有某種形式的儲存體 (暫存資料佇列、作業系統 (OS) 映像儲存體)。

| **元件** | **威脅** | **緩和** | **風險** | **實作** |
| --- | --- | --- | --- | --- |
| 裝置儲存空間 |TRID |儲存體加密、簽署記錄檔 |讀取儲存體的資料 (PII)、竄改遙測資料。 竄改排入佇列或快取的命令控制資料。 竄改組態或韌體更新封包，而本機快取或佇列可能會導致 OS 及/或系統元件遭到入侵 |加密、訊息驗證碼 (MAC) 或數位簽章。 盡可能透過資源的存取控制清單 (ACL) 或權限，進行強式存取控制。 |
| 裝置 OS 映像 |TRID | |竄改OS/取代 OS 元件 |唯讀 OS 分割區、簽署 OS 映像、加密 |
| 現場閘道器儲存體 (佇列資料) |TRID |儲存體加密、簽署記錄檔 |讀取儲存體的資料 (PII)、竄改遙測資料、竄改排入佇列或快取的命令控制資料。 竄改組態或韌體更新封包 (指向裝置或現場閘道器)，而本機快取或佇列可能會導致 OS 及/或系統元件遭到入侵 |BitLocker |
| 現場閘道器 OS 映像 |TRID | |竄改OS/取代 OS 元件 |唯讀 OS 分割區、簽署 OS 映像、加密 |

### <a name="device-and-event-processingcloud-gateway-zone"></a>裝置和事件處理/雲端閘道器區域
雲端閘道器是一種系統，其可讓跨公用網路空間之數個不同站台的裝置之間進行遠端通訊；其通常是針對雲端式控制和資料分析系統，也可說是這類系統的同盟。 在某些情況下，雲端閘道器可立即提升特殊用途裝置的終端機存取速度 (如平板電腦或手機)。 在此處所討論的內容中，「雲端」是指未繫結至連接裝置或現場閘道器之相同網站的專屬資料處理系統，且其中用來防止實體存取目標的作業措施並不一定要向 「公用雲端」基礎結構公開。  雲端閘道器可能會對應到網路虛擬化重疊，以隔離雲端閘道器與所有連接裝置或現場閘道器的任何其他網路流量。 雲端閘道器本身不屬於裝置控制系統，也不是處理或儲存裝置資料的設備；反之，是這些設備與雲端閘道器接合。 雲端閘道器區域包含雲端閘道器和所有現場閘道器，以及直接或間接連接其上的裝置。

雲端閘道器通常是指以服務形式執行且自訂建置的軟體，其含有公開的端點供現場閘道器和裝置進行連線。 因此，它的設計必須完全考慮到安全性問題。 請遵循 [SDL](http://www.microsoft.com/sdl) 程序來設計和建置此服務。 

#### <a name="services-zone"></a>服務區域
控制系統 (或控制器) 是一種軟體解決方案，其可與裝置、現場閘道器或雲端閘道器接合，以控制一個或多個裝置，以便收集、儲存及/或分析裝置資料，以進行簡報或後續的控制用途。 在本討論範圍中，控制系統是唯一可立即協助與人互動的實體。 裝置上的中繼實體控制面 (像是可讓使用者關閉裝置或變更其他屬性的交換器) 則屬例外情況，包括不含任何可數位存取之對等功能等情況。 

在中繼實體控制介面中，任何類型的控制邏輯皆可限制實體控制介面的功能，使得對等的功能可以從遠端啟動或避免遠端輸入的輸入衝突 – 這類中繼控制介面在概念上是連接到本機控制系統，該系統運用的基礎功能會與裝置可平行附加之任何其他遠端控制系統相同。 請參閱[雲端安全性聯盟 (CSA)](https://cloudsecurityalliance.org/research/top-threats/) 頁面，以了解雲端運算的主要威脅。

## <a name="additional-resources"></a>其他資源
如需詳細資訊，請參閱下列文章：

* [SDL 威脅模型化工具](https://www.microsoft.com/sdl/adopt/threatmodeling.aspx)
* [Microsoft Azure IoT 參考架構](https://azure.microsoft.com/updates/microsoft-azure-iot-reference-architecture-available/)

